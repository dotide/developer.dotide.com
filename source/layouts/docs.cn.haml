= wrap_layout 'cn' do
  .row.main-content
    .large-3.small-12.columns
      .hide-for-small
        .sidebar
          %nav
            %ul.side-nav
              %li.heading
                %i.fa.fa-globe
                = 'API'
              %li.nav-api-http
                = link_to 'HTTP API', '/v2/api/http/overview.html'
              %li.nav-api-protobuf
                = link_to 'Protobuf API', '/v2/api/protobuf/overview.html'
              %li.divider
              %li.heading
                %i.fa.fa-cogs
                = '数据操作'
              %li.nav-data-concepts
                = link_to '相关概念', '/v2/data/concepts.html'
              %li.nav-data-database
                = link_to '数据库操作', '/v2/data/database.html'
              %li.nav-data-datastream
                = link_to '数据流操作', '/v2/data/datastream.html'
              %li.nav-data-datapoint
                = link_to '数据点操作', '/v2/data/datapoint.html'
              %li.nav-data-dataprocessing
                = link_to '数据分析处理', '/v2/data/dataprocessing.html'
              %li.divider
              %li.heading
                %i.fa.fa-key
                = '权限控制'
              %li.nav-auth-overview
                = link_to '概述', '/v2/auth/overview.html'
              %li.nav-auth-authentication
                = link_to '认证', '/v2/auth/authentication.html'
              %li.nav-auth-authorization
                = link_to '授权', '/v2/auth/authorization.html'
              %li.divider
              %li.heading
                %i.fa.fa-coffee
                = 'MapReduce'
              %li.nav-mr-overview
                = link_to '概述', '/v2/mr/overview.html'
              %li.nav-mr-map
                = link_to 'Map', '/v2/mr/map.html'
              %li.nav-mr-reduce
                = link_to 'Reduce', '/v2/mr/reduce.html'
              %li.divider
              %li.heading
                %i.fa.fa-wrench
                = '管理界面'
              %li.nav-admin-account
                = link_to '帐号管理', '/admin/account.html'
              %li.nav-admin-db
                = link_to '数据库管理', '/admin/db.html'
              %li.divider
              %li.heading
                %i.fa.fa-rocket
                = 'API 客户端'
              %li.nav-libs-python
                = link_to 'Python', '/libs/python.html'
              %li.nav-libs-ruby
                = link_to 'Ruby', '/libs/ruby.html'
              %li.heading
                %a.button.primary{href: 'https://dashboard.dotide.com/login'}= '使用 Dotide'
    .large-9.small-12.columns
      .right-content
        - if content_for? :raw_content
          = yield_content :raw_content
        - else
          %h1= current_page.data.title
          - if current_page.data.outlines
            %ul.toc
              - current_page.data.outlines.each_with_index do |o, i|
                %li
                  %a{href: "##{i+1}-#{o.gsub(/\s+/, '-')}"}= o
          .markdown= yield

  - content_for :second_nav do
    %ul.off-canvas-list
      %li
        %label= 'API'
      %li.nav-api-http
        = link_to 'HTTP API', '/v2/api/http/overview.html'
      %li.nav-api-protobuf
        = link_to 'Protobuf API', '/v2/api/protobuf/overview.html'
      %li
        %label= '数据操作'
      %li.nav-data-concepts
        = link_to '相关概念', '/v2/data/concepts.html'
      %li.nav-data-database
        = link_to '数据库操作', '/v2/data/database.html'
      %li.nav-data-datastream
        = link_to '数据流操作', '/v2/data/datastream.html'
      %li.nav-data-datapoint
        = link_to '数据点操作', '/v2/data/datapoint.html'
      %li.nav-data-dataprocessing
        = link_to '数据分析处理', '/v2/data/dataprocessing.html'
      %li
        %label= '认证与授权'
      %li.nav-auth-overview
        = link_to '概述', '/v2/auth/overview.html'
      %li.nav-auth-basic
        = link_to '认证', '/v2/auth/authentication.html'
      %li.nav-auth-token
        = link_to '授权', '/v2/auth/authorization.html'
      %li
        %label= 'MapReduce'
      %li.nav-mr-overview
        = link_to '概述', '/v2/mr/overview.html'
      %li.nav-mr-map
        = link_to 'Map', '/v2/mr/map.html'
      %li.nav-mr-reduce
        = link_to 'Reduce', '/v2/mr/reduce.html'
      %li
        %label= '管理界面'
      %li.nav-admin-account
        = link_to '帐号管理', '/admin/account.html'
      %li.nav-admin-db
        = link_to '数据库管理', '/admin/db.html'
      %li
        %label='API 客户端'
      %li.nav-libs-python
        = link_to 'Python', '/libs/python.html'
      %li.nav-libs-ruby
        = link_to 'Ruby', '/libs/ruby.html'

  - content_for :javascripts do
    :javascript
      $('li.nav-docs').addClass('active');
      $("li.nav-#{current_page.data.category}-#{current_page.data.section}").addClass('active');
      $('.markdown h2').each(function(idx, elem) {
        var id = (idx + 1).toString() + '-' + $(elem).text().replace(/\s+/g, '-');
        var html = '<a href=#' + id + '><i class="fa fa-chain"></i></a>';
        $(this).prepend(html);
        $(this).addClass('subheader');
        return $(this).attr('id', id);
      });
